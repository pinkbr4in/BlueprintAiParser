<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Unreal Engine Blueprint Parser</title>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.6.0/dist/css/bootstrap.min.css">
    <link rel="stylesheet" href="{{ url_for('static', filename='blueprint-parser.css') }}">
    <link rel="stylesheet" href="{{ url_for('static', filename='blueprint-highlight.css') }}">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/styles/atom-one-dark.min.css">
    <style>
        /* Styles from previous version (keep these) */
        .processing-indicator { padding: 15px; background-color: #e2f3fe; border: 1px solid #bde0fe; color: #0c5460; border-radius: 4px; margin-bottom: 20px; text-align: center; display: none; justify-content: center; align-items: center; }
        .processing-indicator .spinner-border { width: 1.5rem; height: 1.5rem; vertical-align: -0.25em; margin-right: 8px; }
        #results-area { display: none; margin-top: 20px; }
        #error-display { display: none; margin-top: 15px; }
        /* Ensure copy buttons are hidden initially */
        #human .btn, #ai .btn { display: none; }
        /* Add styles for stats summary if needed */
        .stats-summary { border: 1px solid #eee; padding: 10px; background-color: #f9f9f9; border-radius: 4px; font-size: 0.9em; }
        .markdown-body table { /* Basic table styling if needed */
             border-collapse: collapse; width: 100%; margin-bottom: 1rem;
        }
        .markdown-body th, .markdown-body td {
            padding: 8px; border: 1px solid #ddd; text-align: left;
        }
         .markdown-body th { background-color: #f2f2f2; }
    </style>
</head>
<body>
    <div class="container mt-4 mb-5">
        <h1>Unreal Engine Blueprint Parser</h1>
        <p>Paste the raw text copied from the Blueprint editor below and click "Parse Blueprint".</p>

        <form class="mb-4" id="blueprint-form">
            <input type="hidden" name="csrf_token" id="csrf_token" value="{{ csrf_token() }}">
            <div class="form-group">
                <label for="blueprintText">Paste Blueprint Text:</label>
                <textarea id="blueprintText" name="blueprint_text" rows="15" class="form-control code-input" placeholder="Begin Object Class=... End Object">{{ raw_blueprint_text }}</textarea>
            </div>
            <button type="submit" id="parse-button" class="btn btn-success btn-lg">Parse Blueprint</button>
        </form>

        <div id="error-display" class="alert" role="alert"></div>
        <div id="processing-indicator" class="processing-indicator" role="status">
            <span class="spinner-border spinner-border-sm" aria-hidden="true"></span>
            <span id="processing-message">Processing Blueprint...</span>
        </div>

        <div id="results-area">
             <div class="row">
                 <div class="col-md-12">
                     <div class="card">
                         <div class="card-header">
                             <ul class="nav nav-tabs card-header-tabs" id="outputTabs" role="tablist">
                                 <li class="nav-item"><a class="nav-link active" id="human-tab" data-toggle="tab" href="#human" role="tab" aria-controls="human" aria-selected="true">Human-Readable</a></li>
                                 <li class="nav-item"><a class="nav-link" id="ai-tab" data-toggle="tab" href="#ai" role="tab" aria-controls="ai" aria-selected="false">AI-Readable (JSON)</a></li>
                             </ul>
                         </div>
                         <div class="card-body">
                             <div class="tab-content" id="outputTabContent">
                                 <div class="tab-pane fade show active" id="human" role="tabpanel" aria-labelledby="human-tab">
                                     <div id="stats-summary-content" class="stats-summary mb-3" style="display: none;"></div>
                                     <button id="copy-text-btn" class="btn btn-secondary btn-sm mb-2 float-right">Copy Text</button>
                                     <div style="clear:both;"></div>
                                     <div class="markdown-body" id="human-readable-content">
                                         <p class="text-muted initial-placeholder">Results will appear here after parsing.</p>
                                     </div>
                                 </div>
                                 <div class="tab-pane fade" id="ai" role="tabpanel" aria-labelledby="ai-tab">
                                     <button id="copy-json-btn" class="btn btn-secondary btn-sm mb-2 float-right">Copy JSON</button>
                                     <div style="clear:both;"></div>
                                     <pre id="ai-code-container" style="display: none;"><code class="language-json" id="ai-readable-content"></code></pre>
                                     <p id="ai-placeholder" class="text-muted initial-placeholder">AI-readable JSON output will appear here after parsing.</p>
                                 </div>
                             </div>
                         </div>
                     </div>
                 </div>
             </div>
         </div>
    </div>

    <!-- Core Libraries -->
    <script src="https://code.jquery.com/jquery-3.5.1.slim.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/popper.js@1.16.1/dist/umd/popper.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@4.6.0/dist/js/bootstrap.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/highlight.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/languages/json.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/uuid/8.3.2/uuid.min.js"></script>
    
    <!-- Custom Scripts -->
    <script src="{{ url_for('static', filename='js/scripts.js') }}"></script>
    <script src="{{ url_for('static', filename='js/chunked-upload.js') }}"></script>
</body>
</html>